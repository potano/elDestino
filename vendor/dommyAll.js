// Copyright Â© 2018-2024 Michael Thompson
// SPDX-License-Identifier: GPL-2.0-or-later
// 1719625071
(function(){var globalContext=this;var have={};try{have.window=!!window}catch(e){}have.dom=!!this.document;have.json=this.JSON instanceof Object&&this.JSON.stringify instanceof Function&&this.JSON.parse instanceof Function;have.msie=false;try{have.msie=navigator.cpuClass.length&&!window.opera}catch(e){}var onloadEvents=[];function loader(){for(var evts=walker(onloadEvents);evts();){evts.value.call()}}var idSeq=100;function walker(arr){var i=-1,lim=arr.length;function fn(){if(++i<lim){fn.key=i;fn.value=arr[i];return true}return false}return fn}function keyWalker(obj){return walker(getProperties(obj))}function objWalker(obj){var arr=getProperties(obj),i=-1,lim=arr.length;function fn(){if(++i<lim){fn.key=arr[i];fn.value=obj[arr[i]];return true}return false}return fn}function getProperties(obj){var arr=[],key;for(key in obj){if(obj.hasOwnProperty(key)){arr.push(key)}}return arr}function getAllProperties(obj){var arr=[],key;for(key in obj){arr.push(key)}return arr}function getPropertyValue(prop,objlist,defVal){for(var wk=walker(objlist);wk();){if(prop in wk.value){return wk.value[prop]}}return defVal}function array_index(arr,value,start){start=start||0;while(start<arr.length){if(arr[start]===value){return start}start++}return-1}function object_key(obj,value){for(var wk=objWalker(obj);wk();){if(wk.value===value){return wk.key}}return null}function makeObjFromKeys(keys,value){var out={};for(var wk=walker(keys);wk();){out[wk.value]=value}return out}function objApply(target,source){for(var wk=objWalker(source);wk();){target[wk.key]=wk.value}return target}function objApplyMissing(target,source){for(var wk=objWalker(source);wk();){if(!target.hasOwnProperty(wk.key)){target[wk.key]=wk.value}}return target}function objApplyOnly(target,source){for(var wk=objWalker(target);wk();){var key=wk.key;if(key in source){target[key]=source[key]}}return target}function objMerge(){var aw=walker(arguments),kw,out={};while(aw()){for(kw=objWalker(aw.value);kw();){out[kw.key]=kw.value}}return out}function copyArray(arr,targ){var out=targ||[],i;for(i=0;i<arr.length;i++){out.push(arr[i])}return out}function getClass(o){return Object.prototype.toString.call(o).slice(8,-1)}function extend(baseClass,newClass,settings){var proto=new baseClass;for(var i=2;i<arguments.length;++i){objApply(proto,arguments[i])}newClass.prototype=proto;return newClass}function curry(fn){var args=[],scope=null,i;if(!(fn instanceof Function)){scope=fn[0];fn=fn[1]}for(i=1;i<arguments.length;++i){args.push(arguments[i])}return function(){var useargs=[];for(i=walker(args);i();){useargs.push(i.value)}for(i=walker(arguments);i();){useargs.push(i.value)}return fn.apply(scope,useargs)}}function setAttribute(elem,att,value){if(value instanceof Object){if(value instanceof Function){value=value(elem)}if(value instanceof Array){value=value.join(" ")}}var pos=att.indexOf(":");if(pos<0){elem.setAttribute(att,value)}else{var prefix=att.substr(0,pos);if(prefix=="xmlns"){elem.setAttributeNS("http://www.w3.org/2000/xmlns/",att.substr(pos+1),value)}else{elem.setAttributeNS(elem.lookupNamespaceURI(prefix),att,value)}}}function applyAttributes(elem,atts){var key;for(key in atts){if(atts.hasOwnProperty(key)&&key.match(/^[A-Za-z]/)){setAttribute(elem,key,atts[key])}}}function getAttribute(elem,att){return elem.getAttribute(att)}function getAttributeWords(elem,att){var val=elem.getAttribute(att),out=[];if(val){val=val.split(" ");for(var i=0;i<val.length;++i){var v=val[i];if(v.length){out.push(v)}}}return out}function getAttributes(elem){var out={},name;for(var wk=walker(elem.attributes);wk();){out[wk.value.name]=wk.value.value}return out}function removeAttribute(elem,att){return elem.removeAttribute(att)}function loadJsAsync(url){var elem=document.createElement("script");elem.setAttribute("type","text/javascript");elem.setAttribute("src",url);window.document.head.appendChild(elem)}var tagRE=/^((?:[\w-]+:)?[a-zA-Z][\w-]*)\s*(.*)$/;var othRE=/^(["'])(.*?)\1\s*|^([!_])(.*)$|([:?])([a-zA-Z][\w-]*)(?:\s+(.*))?$/;var attRE=/^(@?)((?:[\w-]+:)?[\w$-]+)=(?:(['"])(.*?)\3|(\S*))\s*(.*)$/;var encRE=/[^\w.~-]/g;var encFn=function(c){return" "==c?"+":"%"+("0"+c.charCodeAt(0).toString(16)).slice(-2)};var decRE=/%([0-9A-Fa-f]{2})|\+/g;var decFn=function(p,c){return"+"==p?" ":String.fromCharCode(parseInt(c,16))};function urlencode(str){return str.replace(encRE,encFn)}function urldecode(str){return str.replace(decRE,decFn)}var url={toQuery:function(obj,doEscape){var out=[],wk=objWalker(obj);while(wk()){out.push(wk.key+"="+encode(wk.value))}return out.join(doEscape?"&amp;":"&")},fromQuery:function(str){var out={},pt;str=str.split("&");while(str.length){pt=str.shift().split("=",2);if(pt.length==2){out[pt[0]]=decode(pt[1])}}return out}};function xmlencode(str){return str.replace(/[&<>'"]/g,function(item){return char2ent[item]})}function xmldecode(str){return str.replace(/&(amp|lt|gt|apos|quot);/g,function(i,item){return ent2char[item]})}var dybase={c:{},globalContext:globalContext,have:have,makeID:function(){return"DY_"+idSeq++},walker:walker,getProperties:getProperties,getAllProperties:getAllProperties,getPropertyValue:getPropertyValue,makeObjFromKeys:makeObjFromKeys,keyWalker:keyWalker,objWalker:objWalker,objApply:objApply,objApplyMissing:objApplyMissing,objApplyOnly:objApplyOnly,objMerge:objMerge,copyArray:copyArray,getClass:getClass,curry:curry,extend:extend,setAttribute:setAttribute,setAttributes:applyAttributes,getAttribute:getAttribute,getAttributes:getAttributes,removeAttribute:removeAttribute,Bounds:Bounds,urlencode:urlencode,urldecode:urldecode,xmlencode:xmlencode,xmldecode:xmldecode,loadJsAsync:loadJsAsync};var docClasses={},docHelpers={},loadedModules;function loadExtensions(){loadedModules=getProperties(dommy.c);for(var wk=objWalker(dommy.c);wk();){if(wk.value.length!=2){continue}var fn=wk.value[1];switch(wk.value[0]){case"cls":docClasses[wk.key]=fn;break;case"dh":docHelpers[wk.key]=fn;break;case"ext":dommy[wk.key]=fn}}delete dommy.c;loadExtensions=function(){}}function mkDoc(options){loadExtensions();if(options){if(options.HTMLDocument instanceof Function&&options.documentElement&&options.documentElement.nodeType==9){return getDomLibrary({type:"html",global:options,document:options.document,body:options.document.body})}return getDomLibrary(options)}if(globalContext.document&&globalContext.document.body){return getDomLibrary({type:"html",document:globalContext.document,root:globalContext.document.documentElement,body:globalContext.document.body})}return null}if(this.dommy&&dommy.c instanceof Object){dybase.c=dommy.c}dommy=objApply(mkDoc,dybase);objApply(dommy,{onload:function(evthand){onloadEvents.push(evthand)}});var setOnload=have.window;if(setOnload){if(window.$===undefined){if(window.onload){pl.onload(window.onload)}window.onload=loader}else{$(document).ready(loader)}}function DyDom(node){this.dom=node;this._dyData={}}objApply(DyDom.prototype,function(){return{setAttributes:function(obj){applyAttributes(this.dom,obj);return this},setAttribute:function(att,value){setAttribute(this.dom,att,value);return this},getAttributes:function(){return getAttributes(this.dom)},getAttribute:function(att){return getAttribute(this.dom,att)},getAttributeWords:function(att){return getAttributeWords(this.dom,att)},removeAttribute:function(att){removeAttribute(this.dom,att);return this},addAttributeWord:function(att,value){var words=this.getAttributeWords(att);if(array_index(words,value)>=0){return this}words.push(value);return this.setAttribute(att,words)},removeAttributeWord:function(att,value){var words=this.getAttributeWords(att);for(var i=words.length-1;i>=0;i--){if(value===words[i]){words.splice(i,1)}}return this.setAttribute(att,words)},hasAttributeWord:function(att,value){return array_index(this.getAttributeWords(att),value)>=0},getClass:function(){return this.getAttribute("class")},setClass:function(value){this.setAttribute("class",value);return this},getClassList:function(){return this.getAttributeWords("class")},setClassList:function(classes){return this.setClass(classes)},addClass:function(value){return this.addAttributeWord("class",value)},removeClass:function(value){return this.removeAttributeWord("class",value)},controlClass:function(value,flag){return flag?this.addClass(value):this.removeClass(value)},hasClass:function(value){return this.hasAttributeWord("class",value)},getComputedStyle:function(pseudo){return getComputedStyle(this.dom,pseudo)},move:function(where){var dd=this.dom;if(where.hasOwnProperty("x")){dd.style.left=where.x+"px"}if(where.hasOwnProperty("y")){dd.style.top=where.y+"px"}if(where.hasOwnProperty("width")){dd.style.width=where.width+"px"}if(where.hasOwnProperty("height")){dd.style.height=where.height+"px"}if(where.hasOwnProperty("before")){var that=where.before.dom||where.before;if(that){that.parentNode.insertBefore(dd,that)}}else if(where.hasOwnProperty("after")){var that=where.after.dom||where.after;if(that&&that.parentNode){that.parentNode.insertBefore(dd,that.nextSibling)}}else if(where.hasOwnProperty("first")){var that=where.first.dom||where.first;if(that&&that.parentNode){that.insertBefore(dd,that.firstChild)}}else if(where.hasOwnProperty("last")){var that=where.last.dom||where.last;if(that&&that.parentNode){that.appendChild(dd)}}return this},removeChildren:function(){while(this.dom.childNodes.length){this.dom.removeChild(this.dom.firstChild)}return this},removeNode:function(){this.dom.parentNode.removeChild(this.dom)},setPosition:function(x,y){if(x instanceof Object){y=x.y;x=x.x}this.dom.style.left=x+"px";this.dom.style.top=y+"px"},setSize:function(width,height){if(width instanceof Object){height=width.height;width=width.width}this.dom.style.width=width+"px";this.dom.style.height=height+"px"},setText:setTextValue,getText:getTextValue,addText:function(text){this.dom.appendChild(this.dom.ownerDocument.createTextNode(text));return this},setValue:setTextValue,getValue:getTextValue,show:function(flag){return setVisible(this,flag,true,true)},hide:function(flag){return setVisible(this,flag,false,true)},cloak:function(flag){return setVisible(this,flag,false,false)},toXML:function(){if(XMLSerializer){return(new XMLSerializer).serializeToString(this.dom)}else{return this.dom.xml}}};function setValueAttr(text){this.dom.value=text;return this}function getValueAttr(){return this.dom.value}function getTextNodes(elem){var lead,leads=[];for(var wk=walker(copyArray(elem.childNodes));wk();){node=wk.value;if(node.nodeType==3||node.nodeType==4){if(lead){lead.appendData(node.data);node.parentNode.removeChild(node)}else{lead=node;leads.push(node)}}else{lead=null}}return leads}function getTextValue(index){var nodes=getTextNodes(this.dom);return index?index<nodes.length?nodes[index].data:null:nodes.length?nodes[0].data:""}function setTextValue(text,index){var nodes=getTextNodes(this.dom);if(nodes.length){index=index||0;if(index<nodes.length){nodes[index].data=text}}else{nodes.push(this.dom.ownerDocument.createTextNode(text));this.dom.appendChild(nodes[0])}return this}function setVisible(obj,flag,dflt,hide){flag=flag===undefined?dflt:dflt?flag:!flag;if(flag){if(obj._dyData.restoreDisplay){obj.dom.style.display=obj._dyData.restoreDisplay;delete obj._dyData.restoreDisplay}else if("none"==getComputedStyle(obj.dom).display){obj.dom.style.display=""}obj.dom.style.visibility="visible"}else{if(hide&&!obj._dyData.restoreDisplay){obj._dyData.restoreDisplay=getComputedStyle(obj.dom).display;obj.dom.style.display="none"}obj.dom.style.visibility="hidden"}return obj}}());function getDomLibrary(options){var nss={0:DyDom};var baseDocument=options.document=options.document||options.global.document;options.type=options.type||"html";options.global=options.global||globalContext;options.root=options.root||baseDocument.documentElement;options.body=options.body||options.root;var isNode=function(){return options.global.Node?function(e){return e instanceof options.global.Node}:function(e){return e&&e.nodeType}}();var isElementNode=function(){return options.global.Node?function(e){return e instanceof options.global.Node&&e.nodeType==1}:function(e){return e&&elem.nodeType==1}}();var getComputedStyle=function(){return options.global.getComputedStyle?function(node){return options.global.getComputedStyle(node)}:function(node){return node.currentStyle}}();var doc=objApply({isNode:isNode,isElementNode:isElementNode,getComputedStyle:getComputedStyle,document:baseDocument,global:options.global},dybase);function getContextMethods(nsSymbol,factory,createElementNode){return{append:function(spec,nameobj){specToElement(this.dom,spec,nameobj,false);return this},tag:function(spec,nameobj){var e=specToElement(null,spec,nameobj,true);if(e){this.dom.appendChild(e.dom)}return e},wrap:function(spec,nameobj){return specToElement(null,spec,nameobj,true)},wrapNS:wrapNS};function specToElement(anchor,spec,nameobj,returnDyDom){var e,elem={},last,dc,tip;inner(anchor,spec);flush();return tip;function inner(anchor,spec,context){var res,key,i;last=anchor;while(spec instanceof Function){spec=spec(nameobj,last)}if("string"==typeof spec){var atFirst=true;while(spec.length){if(res=tagRE.exec(spec)){flush(createElementNode(res[1]));spec=res[2]}else if(res=othRE.exec(spec)){if(res[1]&&res[1].length){flush(baseDocument.createTextNode(res[2]));spec=spec.substr(res[0].length)}else if(res[3]=="_"){flush(baseDocument.createTextNode(res[4]));return}else if(res[3]=="!"){flush(baseDocument.createComment(res[4]));return}else if(res[5]==":"){key=res[6];spec=res[7];if(context){atFirst|=context.pos==1;spec=[spec];while(context.pos<context.spec.length){if(atFirst||!(context.spec[context.pos]instanceof Array)){spec.push(context.spec[context.pos++])}}}dc=wrapNS(key,spec,nameobj);spec="";if(atFirst&&!tip&&returnDyDom){tip=dc}flush(dc.dom)}else if(res[5]=="?"){flush(baseDocument.createProcessingInstruction(res[6],res[7]||""));return}}else{flush(baseDocument.createTextNode("Error: "+spec));return}while(spec.length&&(res=attRE.exec(spec))){key=res[res[3]?4:5];if(res[1]){key=nameobj&&nameobj[key]?nameobj[key]:""}elem[res[2]]=key;spec=res[6]}atFirst=false}}else if(spec instanceof Array){var speclen=spec.length;if(!speclen){return null}var ctx={spec:spec,pos:1};inner(anchor,spec[0],ctx);anchor=last;if(!anchor){return}while(ctx.pos<spec.length){inner(anchor,spec[ctx.pos++],ctx)}}else if(isNode(spec)){flush(spec)}else if(spec instanceof DyDom){flush(spec.dom)}else if(spec instanceof Object){if(spec[0]){flush(createElementNode(spec[0]));anchor=last;objApply(elem,spec);for(i=1;;++i){if(!spec[i]){break}inner(anchor,spec[i]);flush()}}else{objApply(elem,spec)}}}function flush(next){var idkey,obj,isElem;if(e){idkey=elem.$;isElem=e.nodeType==1;if(isElem){applyAttributes(e,elem);if(elem._){e.appendChild(baseDocument.createTextNode(elem._))}}if(idkey!=null){obj=isElem?factory(e):dyTextFactory(e);if(idkey instanceof Function){idkey=idkey(obj,nameobj)}if(nameobj&&idkey!=null&&!(idkey instanceof Object)){nameobj[idkey]=obj}}}elem={};e=next;if(e){if(!tip){tip=returnDyDom?dyFactory(e):e}if(last){last.appendChild(e)}if(e.nodeType==1){last=e}}}}function dyFactory(node){if(node.nodeType==1){return factory(node)}if(node.nodeType==3||node.nodeType==4){return dyTextFactory(node)}return false}}function wrapNS(ns,spec,nameobj){var obj=getDyDomConstructor(ns);if(!obj){return null}return new obj(options.root).wrap(spec,nameobj)}function getDyDomConstructor(key){if(nss[key]){return nss[key]}if(docClasses[key]){return nss[key]=docClasses[key](nss,options,doc,getContextMethods,docHelpers)}return false}if(!(nss[""]=getDyDomConstructor(options.type))){function DyXmlElement(elem){DyDom.call(this,elem)}extend(DyDom,DyXmlElement,getContextMethods("xml",function(node){return new DyXmlElement(node)},function(tag){return this.document.createElement(tag)}));nss[""]=DyXmlElement}function DyTextNode(node){DyDom.call(this,node)}extend(DyDom,DyTextNode);function dyTextFactory(node){return new DyTextNode(node)}doc.root=new nss[""](options.root);doc.body=options.root===options.body?doc.root:new nss[""](options.body);doc.wrap=doc.root.wrap;return doc}function Bounds(x,y,width,height){this.x=x;this.y=y;this.width=width;this.height=height}objApply(Bounds.prototype,{addPosition:function(a){this.x+=a.x;this.y+=a.y;return this},subtractPosition:function(s){this.x-=s.x;this.y-=s.y;return this},addSize:function(o){this.width+=o.width;this.height+=o.height;return this},subtractSize:function(o){this.width-=o.width;this.height-=o.height;return this},setPosition:function(x,y){if("object"==typeof x){y=x.y;x=x.x}this.x=x;this.y=y;return this},getPosition:function(){return{x:this.x,y:this.y}},setSize:function(w,h){if("Object"==typeof w){h=w.height;w=w.width}this.width=w;this.height=h;return this},getSize:function(){return{width:this.width,height:this.height}},containsPoint:function(x,y){return x>=this.x&&x<this.x+this.width&&y>=this.y&&y<this.y+this.height},containsBounds:function(comp){return comp.x>=this.x&&comp.x+comp.width<this.x+this.width&&comp.y>=this.y&&comp.y+comp.height<this.y+this.height},constrainWidth:function(ref,margin,minimum){var avail=ref.width-(this.x+(margin>0?margin:0));if(this.width>avail){minimum=minimum>0?minimum:0;this.width=avail>minimum?avail:minimum}return this},adjustTopToConstraint:function(ref,desiredBottomMargin,minimumTopMargin){var bm=desiredBottomMargin>0?desiredBottomMargin:0,mm=minimumTopMargin>0?minimumTopMargin:0;var visible=ref.y+ref.height-(bm+this.y+this.height);if(visible<0){this.y=Math.max(ref.y+mm,this.y+visible)}else if(this.y-mm<ref.y){this.y=ref.y+mm}return this}})})();(function(){var factory;var getXhrObj=function(){if(factory){return factory()}var factories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];while(factories.length){try{factory=factories.shift();return factory()}catch(e){}}throw Error("Browser doesn't do AJAX")};var cancelTimeout=function(){if(this.timer!==undefined){clearTimeout(this.timer);delete this.timer}};var timeoutEvent=function(request){this.abort();request.success=false;request.statusText="timeout";checkin(request)};var headRE=/^([\w-]+)\s*:\s*(.*?)\s*$/;var toCamelRE=/-([a-z])/g;var toCamelFn=function(p,l){return l.toUpperCase()};var readyStateEvent=function(request){if(this.xmlhttp.readyState==4){cancelTimeout();var headers={},rawHeader,i,key,value,result,xmlhttp=this.xmlhttp,rawHeaders=this.xmlhttp.getAllResponseHeaders().split("\n");while(rawHeaders.length){rawHeader=rawHeaders.shift();if(result=headRE.exec(rawHeader)){key=result[1].toLowerCase().replace(toCamelRE,toCamelFn);value=result[2];if(headers.hasOwnProperty(key)){if(headers[key]instanceof Array){headers[key].unshift(value)}else{headers[key]=[headers[key],value]}}else{headers[key]=value}}}request.rcvdHeaders=headers;if(this.aborted){request.status=0;request.statusText="abort"}else{request.status=xmlhttp.status;request.statusText=xmlhttp.statusText}request.success=request.status>=200&&request.status<300;if(headers.contentType&&(key=headers.contentType.match(/^\w+\/[\w-]+/))&&key){request.mimeType=key[0];if(xmlhttp.responseText){request.responseText=xmlhttp.responseText}if(xmlhttp.responseXML){request.responseXML=xmlhttp.responseXML}if("application/json"==request.mimeType.substr(0,16)){request.isJson=1}try{request.responseObject=dommy.json.decode(request.responseText)}catch(e){if(request.isJson){request.success=false}}request.isJson=!!request.responseObject}checkin(request)}};function checkin(request){var cbs=request.callbacks;delete request.callbacks;if(cbs.checkin&&!cbs.checkin(request)){return}var cb=(request.success?cbs.success:cbs.failure)||cbs.callback;if(cb){cb(request)}}var constructor=function(cfg){this.xmlhttp=getXhrObj();this.method=cfg.method;this.uri=cfg.uri||cfg.url;this.checkout=cfg.checkout;this.checkin=cfg.checkin;this.callback=cfg.callback;this.success=cfg.success;this.failure=cfg.failure;this.headers=cfg.headers||{};this.timeout=cfg.timeout};constructor.prototype.abort=function(){cancelTimeout();this.aborted=1;this.xmlhttp.abort()};constructor.prototype.isIdle=function(){var state=this.xmlhttp.readyState;return!state||state>3};constructor.prototype.request=function(){if(!this.isIdle()){return false}var body="",cfg={},i,key,arg;for(i=0;i<arguments.length;++i){arg=arguments[i];if(arg instanceof Object){cfg=dommy.objMerge(cfg,arg)}else if(typeof arg=="string"){body=arg}}var method=cfg.method||this.method||(body.length?"POST":"GET"),uri=cfg.uri||this.uri,headers=cfg.headers||{},checkout=cfg.checkout||this.checkout,checkin=cfg.checkin||this.checkin,callback=cfg.callback||this.callback,success=cfg.success||this.success,failure=cfg.failure||this.failure,timeout=cfg.timeout||this.timeout;if(!uri){throw Error("No URI for AJAX request")}if(this.headers){dommy.objApplyMissing(headers,this.headers)}if(body.length){if(headers.contentType===undefined){headers.contentType="application/x-www-form-urlencoded; charset=utf-8"}}var req={info:cfg.info,method:method,uri:uri,callbacks:{checkin:checkin,callback:callback,success:success,failure:failure},sentHeaders:headers,sentBody:body};if(checkout&&!checkout(req)){return}this.xmlhttp.open(method,uri,!!(checkin||callback||success||failure));if(timeout!==undefined){this.timer=setTimeout(dommy.curry([this,timeoutEvent],req),timeout)}this.xmlhttp.onreadystatechange=dommy.curry([this,readyStateEvent],req);delete this.aborted;for(key in headers){if(headers.hasOwnProperty(key)){arg=headers[key];key=key.slice(0,1).toUpperCase()+key.slice(1).replace(/([A-Z])/g,"-$1");if(arg instanceof Array){for(i=0;i<arg.length;++i){this.xmlhttp.setRequestHeader(key,arg[i])}}else{this.xmlhttp.setRequestHeader(key,arg)}}}this.xmlhttp.send(body.length?body:null)};constructor.prototype.postJson=function(obj,options){options=options||{};this.request({headers:{contentType:"application/json"}},dommy.json.encode(obj),options)};if(!this.dommy){dommy={c:{}}}dommy.c.ajax=["ext",function(obj){return new constructor(obj)}]})();(function(){function css(options,doc){var document=doc.document,walker=doc.walker,objWalker=doc.objWalker;var defaultStylesheet;function Stylesheet(ss){this.ss=ss;this.map=null;this.rules=null}function getSSMap(sso){if(!sso.map){var map={};sso.rules=sso.ss.cssRules||sso.ss.rules;for(var wk=walker(sso.rules);wk();){var rule=wk.value;if(rule.selectorText){map[rule.selectorText]=wk.key}}sso.map=map}return sso.map}dommy.objApply(Stylesheet.prototype,{getRules:function(){getSSMap(this);return this.rules},getRule:function(selector){return this.rules[getSSMap(this)[selector]]},getRuleText:function(selector){var rule=this.getRule(selector);return rule&&rule.style?rule.style.cssText:null},setRule:function(selector,properties){if(typeof properties!="string"){var arr=[];for(var wk=objWalker(properties);wk();){arr.push(wk.key+": "+wk.value)}properties=arr.join("; ")}var map=getSSMap(this),idx=map[selector],ss=this.ss;if(map[idx]){ss.deleteRule?ss.deleteRule(idx):ss.removeRule(idx)}else{this.map[selector]=idx=this.rules?this.rules.length:0}if(ss.insertRule){ss.insertRule(selector+" {"+properties+"}",idx)}else if(ss.addRule){ss.addRule(selector,properties,idx)}return map[idx]},deleteRule:function(selector){var map=getSSMap(this),idx=map[selector],ss=this.ss;if(map[idx]){if(ss(removeRule)){ss.removeRule(idx)}else if(ss.deleteRule){ss.deleteRule(idx)}}return this}});function getStylesheet(n){n=typeof n=="number"?n:document.styleSheets.length-1;return document.styleSheets[n]?new Stylesheet(document.styleSheets[n]):null}function makeStylesheet(){var parent=options.root;if(!parent){return null}for(var wk=walker(parent.childNodes);wk();){if(wk.value.localName=="head"){parent=wk.value;break}}var style=document.createElement("style");parent.appendChild(style);return new Stylesheet(document.styleSheets[document.styleSheets.length-1])}function getDefaultStylesheet(){if(!defaultStylesheet){defaultStylesheet=getStylesheet()||makeStylesheet()}return defaultStylesheet}doc.css={getStylesheet:getStylesheet,makeStylesheet:makeStylesheet,getRule:function(selector){return getDefaultStylesheet().getRule(selector)},setRule:function(selector,properties){return getDefaultStylesheet().setRule(selector,properties)},setRules:function(selectors){getDefaultStylesheet();for(var wk=dommy.objWalker(selectors);wk();){defaultStylesheet.setRule(wk.key,wk.value)}}}}if(!this.dommy){dommy={c:{}}}dommy.c.css=["dh",css]})();(function(){var prevButtonState=0,eventSingleton;var construct=function(nss,options,doc,getContextMethods,helpers){var walker=dommy.walker,objWalker=dommy.objWalker,curry=dommy.curry,Bounds=dommy.Bounds;var baseDocument=options.document,DyDom=nss[0];var track,untrack,eventSingleton;if(doc.document.addEventListener){track=function(type,elem,fn){return elem.addEventListener(type,fn,false)};untrack=function(type,elem,fn){return elem.removeEventListener(type,fn,false)};eventSingleton={stopPropagation:function(){eventSingleton.evt.stopPropagation()},preventDefault:function(){eventSingleton.evt.preventDefault()}}}else if(doc.global.event){track=function(type,elem,fn){elem.attachEvent("on"+type,fn)};untrack=function(type,elem,fn){elem.detachEvent("on"+type,fn)};eventSingleton={stopPropagation:function(){doc.global.event.cancelBubble=true},preventDefault:function(){doc.global.event.returnValue=false},eventPhase:2}}function getTrackerEvtsObj(obj,type){if(!obj._dyData.evts){obj._dyData.evts={}}if(!obj._dyData.evts[type]){obj._dyData.evts[type]={}}return obj._dyData.evts[type]}var byTag={input:DyHtmlInputElement,option:DyHtmlOptionElement,optgroup:DyHtmlOptgroupElement,select:DyHtmlSelectElement};function DyHtmlElement(elem){DyDom.call(this,elem)}dommy.extend(DyDom,DyHtmlElement,{focus:function(){this.dom.focus()},blur:function(){this.dom.blur()},enable:enableInputElement,disable:function(){this.enable(false)},select:selectInputElement,deselect:function(){this.select(false)},isEnabled:isInputElementEnabled,isSelected:isInputElementSelected,getPosition:function(){return{x:this.dom.offsetLeft,y:this.dom.offsetTop}},getAbsolutePosition:function(){var curr=this.dom,x=0,y=0;while(curr){x+=curr.offsetLeft,y+=curr.offsetTop;curr=curr.offsetParent}return{x:x,y:y}},getSize:function(){return{width:this.dom.offsetWidth,height:this.dom.offsetHeight}},getBounds:function(){var d=this.dom;return new Bounds(d.offsetLeft,d.offsetTop,d.offsetWidth,d.offsetHeight)},getAbsoluteBounds:function(){var bounds=this.getBounds(),curr=this.dom.offsetParent;while(curr){bounds.x+=curr.offsetLeft;bounds.y+=curr.offsetTop;curr=curr.offsetParent}return bounds},getParentBounds:function(){var d=this.dom.parentNode;return new Bounds(d.offsetLeft,d.offsetTop,d.offsetWidth,d.offsetHeight)},getVisible:function(){var d=this.dom;return new Bounds(d.scrollLeft,d.scrollTop,d.clientWidth,d.clientHeight)},getParentVisible:function(){var d=this.dom.parentNode;return new Bounds(d.scrollLeft,d.scrollTop,d.clientWidth,d.clientHeight)},setScroll:function(obj){if(obj.x!==undefined){this.dom.scrollLeft=obj.x}if(obj.y!==undefined){this.dom.scrollTop=obj.y}},close:function(){delete this.parts;this.dom.parentNode.removeChild(this.dom)},setHtml:function(str){this.dom.innerHTML=str;return this},getHtml:function(){return this.dom.innerHTML},track:function(type,fn,opts){var eObj=getTrackerEvtsObj(this,type),obj=this;opts=opts||{};var name=opts.name,phase=opts.phase;if(name===undefined){name=dommy.makeID()}if(!eObj[name]){eObj[name]={fn:fn,handler:handler};track(type,this.dom,handler)}return this;function handler(argEvt){var evt=eventSingleton,src=argEvt||doc.global.event,wk,key;for(var wk=walker(["altKey","charCode","clientX","clientY","ctrlKey","currentTarget","eventPhase","shiftKey","type"]);wk();){key=wk.value;if(key in src){evt[key]=src[key]}}evt.evt=src;evt.obj=obj;if(argEvt){evt.charCode=src.charCode;evt.keyCode=src.keyCode;var button=src.button,b=button^prevButtonState;if(b){prevButtonState=button;evt[button]=b&1?0:b&2?2:1}}if(phase&&(phase==1&&evt.eventPhase>2||phase==2&&evt.eventPhase<2||phase>2&&evt.eventPhase!=3)){return}return fn(evt)}},untrack:function(type,fn){var eObj=getTrackerEvtsObj(this,type);if(fn===undefined){for(var wk=objWalker(eObj);wk();){untrack(type,this.dom,wk.value.handler)}this._dyData.evts[type]={}}else if(fn instanceof Function){for(var wk=objWalker(eObj);wk();){if(wk.value.fn===fn){untrack(type,this.dom,wk.value.handler)}}}else if(eObj[fn]){untrack(type,this.dom,eObj[fn].handler);delete eObj[fn]}return this}},getContextMethods("html",function(node){return new(byTag[node.tagName.toLowerCase()]||DyHtmlElement)(node)},function(tag){return baseDocument.createElement(tag)}));function DyHtmlInputElement(elem){DyHtmlElement.call(this,elem)}dommy.extend(DyHtmlElement,DyHtmlInputElement,{getValue:function(){return this.dom.value},setValue:function(val){this.dom.value=val;return this}});function DyHtmlOptionElement(elem){DyHtmlElement.call(this,elem)}dommy.extend(DyHtmlElement,DyHtmlOptionElement,{setText:setLabelAttr,getText:getLabelAttr,select:selectOptionElement,isEnabled:isInputElementEnabled,isSelected:isOptionElementSelected});function DyHtmlOptgroupElement(elem){DyHtmlElement.call(this,elem)}dommy.extend(DyHtmlElement,DyHtmlOptgroupElement,{setText:setLabelAttr,getText:getLabelAttr});function DyHtmlSelectElement(elem){DyHtmlElement.call(this,elem)}dommy.extend(DyHtmlElement,DyHtmlSelectElement,{getOptionMap:getOptionMap_select,locateSelectedOptions:locateSelectedOptions,getText:getSelectedOptionText,getValue:getSelectedOptionValue,setValue:setSelectValue,setRange:setSelectRange,getRange:getSelectRange,selections:{enable:function(name,flag){runOptionSetters(curry(setOptionOptionStatus,this,"enable"),name,flag)},select:function(name,flag){runOptionSetters(curry(setOptionOptionStatus,this,"select"),name,flag)},getStatus:function(name,which){return runOptionGetters(curry(getOptionOptionStatus,this),name,which)}}});function setLabelAttr(text){this.dom.label=text;return this}function getLabelAttr(){return this.dom.label}function getOptionMap_select(){if(!this._dyData.optmap){var map={};for(var wk=walker(this.dom.options);wk();){map[wk.value.value]=wk.value}this._dyData.optmap=map}return this._dyData.optmap}function locateSelectedOptions(){var wk=objWalker(this.getOptionMap()),out=[];while(wk()){if(wk.value.selected){out.push(wk.value)}}return out}function getSelectedOptionText(){var out=[];for(wk=objWalker(this.locateSelectedOptions());wk();){out.push(wk.value.text)}return out.length?this.dom.multiple?out:out[0]:null}function getSelectedOptionValue(){var out=[];for(wk=objWalker(this.locateSelectedOptions());wk();){out.push(wk.value.value)}return out.length?this.dom.multiple?out:out[0]:null}function setSelectValue(text){var optmap=this.getOptionMap();if(this.dom.multiple){var wk=objWalker(optmap);if(!(text instanceof Array)){text=[text]}var map={},twk=walker(text);while(twk()){map[twk.value]=1}while(wk()){wk.value.selected=!!map[wk.key]}}else if(optmap[text]){optmap[text].selected=true}return this}function enableInputElement(flag){this.dom.disabled=!(flag===undefined||flag)}function selectInputElement(flag){this.dom.checked=flag===undefined||!!flag}function selectOptionElement(flag){this.dom.selected=flag===undefined||!!flag}function isInputElementEnabled(){return!this.dom.disabled}function isInputElementSelected(){return this.dom.checked}function isOptionElementSelected(){return this.dom.selected}function setInputOptionStatus(node,method,key,flag){if(node.items[key]){node.items[key][method].call(node.items[key],flag)}}function setOptionOptionStatus(node,method,key,flag){node=node.getOptionMap()[key];if(node){flag=flag===undefined||!!flag;if("select"==method){node.selected=!!flag}else if("enable"==method){node.disabled=!flag}}return this}function runOptionSetters(fn,name,flag){if(name instanceof Array){for(var wk=walker(name);wk();){fn(wk.value,flag)}}else if(name instanceof Object){for(var wk=objWalker(name);wk();){fn(wk.key,wk.value)}}else{fn(name,flag)}}var getterMethods={select:"isSelected",enable:"isEnabled"};function getInputOptionStatus(node,key,method){node=node.items[key];if(node){method=getterMethods[method];if(method){return node[method].call(node)}return{selected:node.isSelected.call(node),enabled:node.isEnabled.call(node)}}return false}function getOptionOptionsStatus(node,key,method){node=node.getOptionMap()[key];if(node){if("select"==method){return node.selected}if("enable"==method){return!node.disabled}return{selected:node.selected,enabled:!node.disabled}}return false}function runOptionGetters(fn,name,which){if(name instanceof Array){var out={};for(var wk=walker(name);wk();){out[wk.value]=fn(wk.value,which)}return out}else{return fn(name,which)}}function getSelectRange(){return getProperties(this.getOptionMap())}function setSelectRange(){var wk=walker(arguments),outindex=0,i;this.dom.options.length=0;this._dyData.optmap={};this.parts={};var optmap=this._dyData.optmap;function mkOption(parent,arg){var mkGroup=false,atts={},text,value,defsel,sel;if(arg instanceof Object){if("group"==arg.type){mkGroup=true;text=arg.text;var children=arg._||[]}else{text=arg.text===undefined?arg.value===undefined?outindex:arg.value:arg.text;value=arg.value===undefined?arg.text:arg.value;defsel=!!arg["default"];sel=!!arg.select}}else{text=value=arg;defsel=sel=false}atts.label=text;atts.value=value;if(defsel){atts.defaultSelected="1"}if(sel){atts.selected="1"}var elem=baseDocument.createElement(mkGroup?"optgroup":"option");dommy.setAttributes(elem,atts);parent.appendChild(elem);if(mkGroup){for(var wk=walker(children);wk();){mkOption(elem,wk.value)}}else{optmap[value]=elem;elem.appendChild(baseDocument.createTextNode(text));++outindex}}while(wk()){if(wk.value instanceof Array){for(i=0;i<wk.value.length;++i){mkOption(this.dom,wk.value[i])}}else{mkOption(this.dom,wk.value)}}return this}function getTrackerEvtsObj(obj,type){if(!obj._dyData.evts){obj._dyData.evts={}}if(!obj._dyData.evts[type]){obj._dyData.evts[type]={}}return obj._dyData.evts[type]}if(helpers.css){helpers.css(options,doc)}if(helpers.drag){helpers.drag(options,doc,DyHtmlElement)}return DyHtmlElement};if(!this.dommy){dommy={c:{}}}dommy.c.html=["cls",construct]})();(function(){function emulatedEncoder(){var exfugiendusRE=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var exfugiendusFn=function(c){var rep={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}[c];return rep?rep:"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)};var encode=function(o){var typo=typeof o,out=[],part;if(typo=="undefined"||typo=="function"){return null}if(o===null){return"null"}if(typeof o.length=="number"&&typeof o.splice=="function"){for(var i=dommy.walker(o);i();){var part=encode(i.value);if(part!==null){out.push(part)}}return"["+out.join(",")+"]"}if(typo=="string"){if(exfugiendusRE.test(0)){o=o.replace(exfugiendusRE,exfugiendusFn)}return'"'+o+'"'}if(typo=="number"){return isFinite(o)?String(o):"null"}if(typo=="boolean"){return String(o)}for(var i in o){if(o.hasOwnProperty(i)){part=encode(o[i]);if(part!==null){out.push('"'+i+'":'+part)}}}return"{"+out.join(",")+"}"};return function(o){if(typeof o=="undefined"||typeof o=="function"){return"null"}return encode(o)}}function emulatedDecoder(){var tokenRE=/^\s*([\[\]{},:]|(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|("(?:(?:\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4}))|[^"])*")|\w+)\s*(.*)$/;function err(str){throw Error("JSON error: "+str)}return function(str){var toktype,tokval;function getToken(){if(!str.length){err("premature end of string")}var res=tokenRE.exec(str);if(!res){err("can't parse token "+str)}tokval=res[1];str=res[4];if(res[2]==tokval){toktype="s"}else if(res[3]==tokval){tokval=eval(tokval);toktype="s"}else{toktype="l"}return toktype}function getValue(){if(getToken()=="s"){return tokval}switch(tokval){case"{":var obj={};for(;;){if(getToken()!="s"){if(","==tokval){continue}if("}"==tokval){toctype="c";return obj}err("object with "+tokval+" as key")}var key=tokval;if(getToken()!="l"&&":"!=tokval){err("missing colon before member")}obj[key]=getValue();if("p"==toktype){err("unexpected "+tokval+" in object")}}case"[":var arr=[];for(;;){var key=getValue();if("p"==toktype){if(","==tokval){continue}if("]"==tokval){toktype="c";return arr}err("array with "+tokval+" instead of element")}arr.push(key)}case"true":toktype="b";return true;case"false":toktype="b";return false;case"null":toktype="b";return null;case",":case":":case"]":case"}":toktype="p";return tokval;default:err("unknown token '"+tokval)}}return getValue()}}var json={};if(this.JSON instanceof Object&&this.JSON.stringify instanceof Function&&this.JSON.parse instanceof Function){json.encode=JSON.stringify,json.decode=JSON.parse}else{json.encode=emulatedEncoder();json.decode=emulatedDecoder()}if(!this.dommy){dommy={c:{}}}dommy.c.json=["ext",json]})();(function(){function getConstr(nss,options,doc,getContextMethods,helpers){var walker=dommy.walker,objWalker=dommy.objWalker,curry=dommy.curry;var baseDocument=options.document,DyHtmlElement=nss["html"]||nss[""];var byTag={};function DySvgElement(elem){DyHtmlElement.call(this,elem)}dommy.extend(DyHtmlElement,DySvgElement,{toUrl:function(){return"data:image/svg+xml,"+encodeURIComponent(this.toXML())}},getContextMethods("svg",function(node){return new(byTag[node.localName]||DySvgElement)(node)},function(tag){var e=baseDocument.createElementNS("http://www.w3.org/2000/svg",tag);if(e.localName=="svg"){e.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg");e.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink")}return e}));if(helpers.css){helpers.css(options,doc)}return DySvgElement}if(!this.dommy){dommy={c:{}}}dommy.c.svg=["cls",getConstr]})();
