// Copyright Â© 2018-2023 Michael Thompson
// SPDX-License-Identifier: GPL-2.0-or-later
!function(){var globalContext=this,have={};try{have.window=!!window}catch(e){}have.dom=!!this.document,have.json=this.JSON instanceof Object&&this.JSON.stringify instanceof Function&&this.JSON.parse instanceof Function,have.msie=!1;try{have.msie=navigator.cpuClass.length&&!window.opera}catch(e){}var onloadEvents=[];function loader(){for(var evts=walker(onloadEvents);evts();)evts.value.call()}var idSeq=100;function walker(arr){var i=-1,lim=arr.length;function fn(){return++i<lim&&(fn.key=i,fn.value=arr[i],!0)}return fn}function objWalker(obj){var arr=getProperties(obj),i=-1,lim=arr.length;function fn(){return++i<lim&&(fn.key=arr[i],fn.value=obj[arr[i]],!0)}return fn}function getProperties(obj){var key,arr=[];for(key in obj)obj.hasOwnProperty(key)&&arr.push(key);return arr}function array_index(arr,value,start){for(start=start||0;start<arr.length;){if(arr[start]===value)return start;start++}return-1}function objApply(target,source){for(var wk=objWalker(source);wk();)target[wk.key]=wk.value;return target}function objMerge(){for(var kw,aw=walker(arguments),out={};aw();)for(kw=objWalker(aw.value);kw();)out[kw.key]=kw.value;return out}function copyArray(arr,targ){for(var out=targ||[],i=0;i<arr.length;i++)out.push(arr[i]);return out}function extend(baseClass,newClass,settings){for(var proto=new baseClass,i=2;i<arguments.length;++i)objApply(proto,arguments[i]);return newClass.prototype=proto,newClass}function setAttribute(elem,att,value){value instanceof Object&&(value=value instanceof Function?value(elem):value)instanceof Array&&(value=value.join(" "));var prefix,pos=att.indexOf(":");pos<0?elem.setAttribute(att,value):"xmlns"==(prefix=att.substr(0,pos))?elem.setAttributeNS("http://www.w3.org/2000/xmlns/",att.substr(pos+1),value):elem.setAttributeNS(elem.lookupNamespaceURI(prefix),att,value)}function applyAttributes(elem,atts){for(var key in atts)atts.hasOwnProperty(key)&&key.match(/^[A-Za-z]/)&&setAttribute(elem,key,atts[key])}function getAttribute(elem,att){return elem.getAttribute(att)}function getAttributes(elem){for(var out={},wk=walker(elem.attributes);wk();)out[wk.value.name]=wk.value.value;return out}function removeAttribute(elem,att){return elem.removeAttribute(att)}var tagRE=/^((?:[\w-]+:)?[a-zA-Z][\w-]*)\s*(.*)$/,nepRE=/^([:@?!])(([a-zA-Z]\w*)\s*(.*))$/,attRE=/^(@?)((?:[\w-]+:)?[\w$-]+)=(?:(['"])(.*?)\3|(\S*))\s*(.*)$/,litRE=/^(?:(["'])(.*?)\1\s*|_(.*))\s*(.*)$/;function encFn(c){return" "==c?"+":"%"+("0"+c.charCodeAt(0).toString(16)).slice(-2)}function decFn(p,c){return"+"==p?" ":String.fromCharCode(parseInt(c,16))}var encRE=/[^\w.~-]/g,decRE=/%([0-9A-Fa-f]{2})|\+/g;var dybase={c:{},globalContext:globalContext,have:have,makeID:function(){return"DY_"+idSeq++},walker:walker,getProperties:getProperties,getAllProperties:function(obj){var key,arr=[];for(key in obj)arr.push(key);return arr},getPropertyValue:function(prop,objlist,defVal){for(var wk=walker(objlist);wk();)if(prop in wk.value)return wk.value[prop];return defVal},makeObjFromKeys:function(keys,value){for(var out={},wk=walker(keys);wk();)out[wk.value]=value;return out},keyWalker:function(obj){return walker(getProperties(obj))},objWalker:objWalker,objApply:objApply,objApplyMissing:function(target,source){for(var wk=objWalker(source);wk();)target.hasOwnProperty(wk.key)||(target[wk.key]=wk.value);return target},objApplyOnly:function(target,source){for(var wk=objWalker(target);wk();){var key=wk.key;key in source&&(target[key]=source[key])}return target},objMerge:objMerge,copyArray:copyArray,getClass:function(o){return Object.prototype.toString.call(o).slice(8,-1)},curry:function(fn){var i,args=[],scope=null;for(fn instanceof Function||(scope=fn[0],fn=fn[1]),i=1;i<arguments.length;++i)args.push(arguments[i]);return function(){var useargs=[];for(i=walker(args);i();)useargs.push(i.value);for(i=walker(arguments);i();)useargs.push(i.value);return fn.apply(scope,useargs)}},extend:extend,setAttribute:setAttribute,setAttributes:applyAttributes,getAttribute:getAttribute,getAttributes:getAttributes,removeAttribute:removeAttribute,Bounds:Bounds,urlencode:function(str){return str.replace(encRE,encFn)},urldecode:function(str){return str.replace(decRE,decFn)},xmlencode:function(str){return str.replace(/[&<>'"]/g,function(item){return char2ent[item]})},xmldecode:function(str){return str.replace(/&(amp|lt|gt|apos|quot);/g,function(i,item){return ent2char[item]})},loadJsAsync:function(url){var elem=document.createElement("script");elem.setAttribute("type","text/javascript"),elem.setAttribute("src",url),window.document.head.appendChild(elem)}},docClasses={},docHelpers={};function loadExtensions(){getProperties(dommy.c);for(var wk=objWalker(dommy.c);wk();)if(2==wk.value.length){var fn=wk.value[1];switch(wk.value[0]){case"cls":docClasses[wk.key]=fn;break;case"dh":docHelpers[wk.key]=fn;break;case"ext":dommy[wk.key]=fn}}delete dommy.c,loadExtensions=function(){}}function DyDom(node){this.dom=node,this._dyData={}}function getTextNodes(elem){for(var lead,leads=[],wk=walker(copyArray(elem.childNodes));wk();)3==(node=wk.value).nodeType||4==node.nodeType?lead?(lead.appendData(node.data),node.parentNode.removeChild(node)):(lead=node,leads.push(node)):lead=null;return leads}function getTextValue(index){var nodes=getTextNodes(this.dom);return index?index<nodes.length?nodes[index].data:null:nodes.length?nodes[0].data:""}function setTextValue(text,index){var nodes=getTextNodes(this.dom);return nodes.length?(index=index||0)<nodes.length&&(nodes[index].data=text):(nodes.push(this.dom.ownerDocument.createTextNode(text)),this.dom.appendChild(nodes[0])),this}function setVisible(obj,flag,dflt,hide){return(flag=void 0===flag?dflt:dflt?flag:!flag)?(obj._dyData.restoreDisplay?(obj.dom.style.display=obj._dyData.restoreDisplay,delete obj._dyData.restoreDisplay):"none"==getComputedStyle(obj.dom).display&&(obj.dom.style.display=""),obj.dom.style.visibility="visible"):(hide&&!obj._dyData.restoreDisplay&&(obj._dyData.restoreDisplay=getComputedStyle(obj.dom).display,obj.dom.style.display="none"),obj.dom.style.visibility="hidden"),obj}function getDomLibrary(options){var nss={0:DyDom},baseDocument=options.document=options.document||options.global.document,isNode=(options.type=options.type||"html",options.global=options.global||globalContext,options.root=options.root||baseDocument.documentElement,options.body=options.body||options.root,options.global.Node?function(e){return e instanceof options.global.Node}:function(e){return e&&e.nodeType}),isElementNode=options.global.Node?function(e){return e instanceof options.global.Node&&1==e.nodeType}:function(e){return e&&1==elem.nodeType},getComputedStyle=options.global.getComputedStyle?function(node){return options.global.getComputedStyle(node)}:function(node){return node.currentStyle},doc=objApply({isNode:isNode,isElementNode:isElementNode,getComputedStyle:getComputedStyle,document:baseDocument,global:options.global},dybase);function getContextMethods(nsSymbol,factory,createElementNode){return{append:function(spec,nameobj){return specToElement(this.dom,spec,nameobj,!1),this},tag:function(spec,nameobj){spec=specToElement(null,spec,nameobj,!0);return spec&&this.dom.appendChild(spec.dom),spec},wrap:function(spec,nameobj){return specToElement(null,spec,nameobj,!0)},wrapNS:wrapNS};function specToElement(anchor,spec,nameobj,returnDyDom){var e,last,dc,tip,elem={};return function inner(anchor,spec,context){var res,key,i;last=anchor;for(;spec instanceof Function;)spec=spec(nameobj,last);if("string"==typeof spec)for(var atFirst=!0;spec.length;){if(res=tagRE.exec(spec))flush(createElementNode(res[1])),spec=res[2];else if(res=nepRE.exec(spec))switch(key=res[3],res[1]){case":":if(spec=res[4],context)for(atFirst|=1==context.pos,spec=[spec];context.pos<context.spec.length;)!atFirst&&context.spec[context.pos]instanceof Array||spec.push(context.spec[context.pos++]);dc=wrapNS(key,spec,nameobj),spec="",atFirst&&!tip&&returnDyDom&&(tip=dc),flush(dc.dom);break;case"?":return void flush(baseDocument.createProcessingInstruction(key,res[4]));case"!":return void flush(baseDocument.createComment(res[2]))}else res=litRE.exec(spec),flush(baseDocument.createTextNode(res?res[res[1]?2:3]:"Error: "+spec)),spec=res&&res[1]?res[4]:"";for(;spec.length&&(res=attRE.exec(spec));)key=res[res[3]?4:5],res[1]&&(key=nameobj&&nameobj[key]?nameobj[key]:""),elem[res[2]]=key,spec=res[6];atFirst=!1}else if(spec instanceof Array){var speclen=spec.length;if(!speclen)return null;var ctx={spec:spec,pos:1};if(inner(anchor,spec[0],ctx),anchor=last)for(;ctx.pos<spec.length;)inner(anchor,spec[ctx.pos++],ctx)}else if(isNode(spec))flush(spec);else if(spec instanceof DyDom)flush(spec.dom);else if(spec instanceof Object)if(spec[0])for(flush(createElementNode(spec[0])),anchor=last,objApply(elem,spec),i=1;spec[i];++i)inner(anchor,spec[i]),flush();else objApply(elem,spec)}(anchor,spec),flush(),tip;function flush(next){var isElem,idkey;e&&(idkey=elem.$,(isElem=1==e.nodeType)&&(applyAttributes(e,elem),elem._&&e.appendChild(baseDocument.createTextNode(elem._))),null!=idkey&&(isElem=(isElem?factory:dyTextFactory)(e),idkey instanceof Function&&(idkey=idkey(isElem,nameobj)),!nameobj||null==idkey||idkey instanceof Object||(nameobj[idkey]=isElem))),elem={},(e=next)&&(tip=tip||(returnDyDom?1!=(idkey=e).nodeType?(3==idkey.nodeType||4==idkey.nodeType)&&dyTextFactory(idkey):factory(idkey):e),last&&last.appendChild(e),1==e.nodeType&&(last=e))}}}function wrapNS(ns,spec,nameobj){ns=getDyDomConstructor(ns);return ns?new ns(options.root).wrap(spec,nameobj):null}function getDyDomConstructor(key){return nss[key]||!!docClasses[key]&&(nss[key]=docClasses[key](nss,options,doc,getContextMethods,docHelpers))}function DyXmlElement(elem){DyDom.call(this,elem)}function DyTextNode(node){DyDom.call(this,node)}function dyTextFactory(node){return new DyTextNode(node)}return(nss[""]=getDyDomConstructor(options.type))||(extend(DyDom,DyXmlElement,getContextMethods(0,function(node){return new DyXmlElement(node)},function(tag){return this.document.createElement(tag)})),nss[""]=DyXmlElement),extend(DyDom,DyTextNode),doc.root=new nss[""](options.root),doc.body=options.root===options.body?doc.root:new nss[""](options.body),doc.wrap=doc.root.wrap,doc}function Bounds(x,y,width,height){this.x=x,this.y=y,this.width=width,this.height=height}this.dommy&&dommy.c instanceof Object&&(dybase.c=dommy.c),dommy=objApply(function(options){return loadExtensions(),options?options.HTMLDocument instanceof Function&&options.documentElement&&9==options.documentElement.nodeType?getDomLibrary({type:"html",global:options,document:options.document,body:options.document.body}):getDomLibrary(options):globalContext.document&&globalContext.document.body?getDomLibrary({type:"html",document:globalContext.document,root:globalContext.document.documentElement,body:globalContext.document.body}):null},dybase),objApply(dommy,{onload:function(evthand){onloadEvents.push(evthand)}}),have.window&&(void 0===window.$?(window.onload&&pl.onload(window.onload),window.onload=loader):$(document).ready(loader)),objApply(DyDom.prototype,{setAttributes:function(obj){return applyAttributes(this.dom,obj),this},setAttribute:function(att,value){return setAttribute(this.dom,att,value),this},getAttributes:function(){return getAttributes(this.dom)},getAttribute:function(att){return getAttribute(this.dom,att)},getAttributeWords:function(att){return function(elem,att){var out=[];if(val=elem.getAttribute(att))for(var val=val.split(" "),i=0;i<val.length;++i){var v=val[i];v.length&&out.push(v)}return out}(this.dom,att)},removeAttribute:function(att){return removeAttribute(this.dom,att),this},addAttributeWord:function(att,value){var words=this.getAttributeWords(att);return 0<=array_index(words,value)?this:(words.push(value),this.setAttribute(att,words))},removeAttributeWord:function(att,value){for(var words=this.getAttributeWords(att),i=words.length-1;0<=i;i--)value===words[i]&&words.splice(i,1);return this.setAttribute(att,words)},hasAttributeWord:function(att,value){return 0<=array_index(this.getAttributeWords(att),value)},getClass:function(){return this.getAttribute("class")},setClass:function(value){return this.setAttribute("class",value),this},getClassList:function(){return this.getAttributeWords("class")},setClassList:function(classes){return this.setClass(classes)},addClass:function(value){return this.addAttributeWord("class",value)},removeClass:function(value){return this.removeAttributeWord("class",value)},controlClass:function(value,flag){return flag?this.addClass(value):this.removeClass(value)},hasClass:function(value){return this.hasAttributeWord("class",value)},getComputedStyle:function(pseudo){return getComputedStyle(this.dom,pseudo)},move:function(where){var that,dd=this.dom;return where.hasOwnProperty("x")&&(dd.style.left=where.x+"px"),where.hasOwnProperty("y")&&(dd.style.top=where.y+"px"),where.hasOwnProperty("width")&&(dd.style.width=where.width+"px"),where.hasOwnProperty("height")&&(dd.style.height=where.height+"px"),where.hasOwnProperty("before")?(that=where.before.dom||where.before)&&that.parentNode.insertBefore(dd,that):where.hasOwnProperty("after")?(that=where.after.dom||where.after)&&that.parentNode&&that.parentNode.insertBefore(dd,that.nextSibling):where.hasOwnProperty("first")?(that=where.first.dom||where.first)&&that.parentNode&&that.insertBefore(dd,that.firstChild):where.hasOwnProperty("last")&&(that=where.last.dom||where.last)&&that.parentNode&&that.appendChild(dd),this},removeChildren:function(){for(;this.dom.childNodes.length;)this.dom.removeChild(this.dom.firstChild);return this},removeNode:function(){this.dom.parentNode.removeChild(this.dom)},setPosition:function(x,y){x instanceof Object&&(y=x.y,x=x.x),this.dom.style.left=x+"px",this.dom.style.top=y+"px"},setSize:function(width,height){width instanceof Object&&(height=width.height,width=width.width),this.dom.style.width=width+"px",this.dom.style.height=height+"px"},setText:setTextValue,getText:getTextValue,setValue:setTextValue,getValue:getTextValue,show:function(flag){return setVisible(this,flag,!0,!0)},hide:function(flag){return setVisible(this,flag,!1,!0)},cloak:function(flag){return setVisible(this,flag,!1,!1)},toXML:function(){return XMLSerializer?(new XMLSerializer).serializeToString(this.dom):this.dom.xml}}),objApply(Bounds.prototype,{addPosition:function(a){return this.x+=a.x,this.y+=a.y,this},subtractPosition:function(s){return this.x-=s.x,this.y-=s.y,this},addSize:function(o){return this.width+=o.width,this.height+=o.height,this},subtractSize:function(o){return this.width-=o.width,this.height-=o.height,this},setPosition:function(x,y){return"object"==typeof x&&(y=x.y,x=x.x),this.x=x,this.y=y,this},getPosition:function(){return{x:this.x,y:this.y}},setSize:function(w,h){return"Object"==typeof w&&(h=w.height,w=w.width),this.width=w,this.height=h,this},getSize:function(){return{width:this.width,height:this.height}},containsPoint:function(x,y){return x>=this.x&&x<this.x+this.width&&y>=this.y&&y<this.y+this.height},containsBounds:function(comp){return comp.x>=this.x&&comp.x+comp.width<this.x+this.width&&comp.y>=this.y&&comp.y+comp.height<this.y+this.height},constrainWidth:function(ref,margin,minimum){ref=ref.width-(this.x+(0<margin?margin:0));return this.width>ref&&(this.width=(minimum=0<minimum?minimum:0)<ref?ref:minimum),this},adjustTopToConstraint:function(ref,desiredBottomMargin,minimumTopMargin){minimumTopMargin=0<minimumTopMargin?minimumTopMargin:0,desiredBottomMargin=ref.y+ref.height-((0<desiredBottomMargin?desiredBottomMargin:0)+this.y+this.height);return desiredBottomMargin<0?this.y=Math.max(ref.y+minimumTopMargin,this.y+desiredBottomMargin):this.y-minimumTopMargin<ref.y&&(this.y=ref.y+minimumTopMargin),this}})}(),!function(){var prevButtonState=0;(dommy=this.dommy?dommy:{c:{}}).c.html=["cls",function(nss,options,doc,getContextMethods,helpers){var track,untrack,eventSingleton,walker=dommy.walker,objWalker=dommy.objWalker,curry=dommy.curry,Bounds=dommy.Bounds,baseDocument=options.document,DyDom=nss[0];function getTrackerEvtsObj(obj,type){return obj._dyData.evts||(obj._dyData.evts={}),obj._dyData.evts[type]||(obj._dyData.evts[type]={}),obj._dyData.evts[type]}doc.document.addEventListener?(track=function(type,elem,fn){return elem.addEventListener(type,fn,!1)},untrack=function(type,elem,fn){return elem.removeEventListener(type,fn,!1)},eventSingleton={stopPropagation:function(){eventSingleton.evt.stopPropagation()},preventDefault:function(){eventSingleton.evt.preventDefault()}}):doc.global.event&&(track=function(type,elem,fn){elem.attachEvent("on"+type,fn)},untrack=function(type,elem,fn){elem.detachEvent("on"+type,fn)},eventSingleton={stopPropagation:function(){doc.global.event.cancelBubble=!0},preventDefault:function(){doc.global.event.returnValue=!1},eventPhase:2});var byTag={input:DyHtmlInputElement,option:DyHtmlOptionElement,optgroup:DyHtmlOptgroupElement,select:DyHtmlSelectElement};function DyHtmlElement(elem){DyDom.call(this,elem)}function DyHtmlInputElement(elem){DyHtmlElement.call(this,elem)}function DyHtmlOptionElement(elem){DyHtmlElement.call(this,elem)}function DyHtmlOptgroupElement(elem){DyHtmlElement.call(this,elem)}function DyHtmlSelectElement(elem){DyHtmlElement.call(this,elem)}function setLabelAttr(text){return this.dom.label=text,this}function getLabelAttr(){return this.dom.label}function isInputElementEnabled(){return!this.dom.disabled}function setOptionOptionStatus(node,method,key,flag){return(node=node.getOptionMap()[key])&&(flag=void 0===flag||!!flag,"select"==method?node.selected=!!flag:"enable"==method&&(node.disabled=!flag)),this}function runOptionSetters(fn,name,flag){if(name instanceof Array)for(var wk=walker(name);wk();)fn(wk.value,flag);else if(name instanceof Object)for(wk=objWalker(name);wk();)fn(wk.key,wk.value);else fn(name,flag)}dommy.extend(DyDom,DyHtmlElement,{focus:function(){this.dom.focus()},blur:function(){this.dom.blur()},enable:function(flag){this.dom.disabled=!(void 0===flag||flag)},disable:function(){this.enable(!1)},select:function(flag){this.dom.checked=void 0===flag||!!flag},deselect:function(){this.select(!1)},isEnabled:isInputElementEnabled,isSelected:function(){return this.dom.checked},getPosition:function(){return{x:this.dom.offsetLeft,y:this.dom.offsetTop}},getAbsolutePosition:function(){for(var curr=this.dom,x=0,y=0;curr;)x+=curr.offsetLeft,y+=curr.offsetTop,curr=curr.offsetParent;return{x:x,y:y}},getSize:function(){return{width:this.dom.offsetWidth,height:this.dom.offsetHeight}},getBounds:function(){var d=this.dom;return new Bounds(d.offsetLeft,d.offsetTop,d.offsetWidth,d.offsetHeight)},getAbsoluteBounds:function(){for(var bounds=this.getBounds(),curr=this.dom.offsetParent;curr;)bounds.x+=curr.offsetLeft,bounds.y+=curr.offsetTop,curr=curr.offsetParent;return bounds},getParentBounds:function(){var d=this.dom.parentNode;return new Bounds(d.offsetLeft,d.offsetTop,d.offsetWidth,d.offsetHeight)},getVisible:function(){var d=this.dom;return new Bounds(d.scrollLeft,d.scrollTop,d.clientWidth,d.clientHeight)},getParentVisible:function(){var d=this.dom.parentNode;return new Bounds(d.scrollLeft,d.scrollTop,d.clientWidth,d.clientHeight)},setScroll:function(obj){void 0!==obj.x&&(this.dom.scrollLeft=obj.x),void 0!==obj.y&&(this.dom.scrollTop=obj.y)},close:function(){delete this.parts,this.dom.parentNode.removeChild(this.dom)},setHtml:function(str){return this.dom.innerHTML=str,this},getHtml:function(){return this.dom.innerHTML},track:function(type,fn,opts){var eObj=getTrackerEvtsObj(this,type),obj=this,name=(opts=opts||{}).name,phase=opts.phase;return eObj[name=void 0===name?dommy.makeID():name]||(eObj[name]={fn:fn,handler:handler},track(type,this.dom,handler)),this;function handler(argEvt){for(var key,b,evt=eventSingleton,src=argEvt||doc.global.event,wk=walker(["altKey","charCode","clientX","clientY","ctrlKey","currentTarget","eventPhase","shiftKey","type"]);wk();)(key=wk.value)in src&&(evt[key]=src[key]);if(evt.evt=src,evt.obj=obj,argEvt&&(evt.charCode=src.charCode,evt.keyCode=src.keyCode,(b=(argEvt=src.button)^prevButtonState)&&(evt[prevButtonState=argEvt]=1&b?0:2&b?2:1)),!phase||!(1==phase&&2<evt.eventPhase||2==phase&&evt.eventPhase<2||2<phase&&3!=evt.eventPhase))return fn(evt)}},untrack:function(type,fn){var eObj=getTrackerEvtsObj(this,type);if(void 0===fn){for(var wk=objWalker(eObj);wk();)untrack(type,this.dom,wk.value.handler);this._dyData.evts[type]={}}else if(fn instanceof Function)for(wk=objWalker(eObj);wk();)wk.value.fn===fn&&untrack(type,this.dom,wk.value.handler);else eObj[fn]&&(untrack(type,this.dom,eObj[fn].handler),delete eObj[fn]);return this}},getContextMethods("html",function(node){return new(byTag[node.tagName.toLowerCase()]||DyHtmlElement)(node)},function(tag){return baseDocument.createElement(tag)})),dommy.extend(DyHtmlElement,DyHtmlInputElement,{getValue:function(){return this.dom.value},setValue:function(val){return this.dom.value=val,this}}),dommy.extend(DyHtmlElement,DyHtmlOptionElement,{setText:setLabelAttr,getText:getLabelAttr,select:function(flag){this.dom.selected=void 0===flag||!!flag},isEnabled:isInputElementEnabled,isSelected:function(){return this.dom.selected}}),dommy.extend(DyHtmlElement,DyHtmlOptgroupElement,{setText:setLabelAttr,getText:getLabelAttr}),dommy.extend(DyHtmlElement,DyHtmlSelectElement,{getOptionMap:function(){if(!this._dyData.optmap){for(var map={},wk=walker(this.dom.options);wk();)map[wk.value.value]=wk.value;this._dyData.optmap=map}return this._dyData.optmap},locateSelectedOptions:function(){var wk=objWalker(this.getOptionMap()),out=[];for(;wk();)wk.value.selected&&out.push(wk.value);return out},getText:function(){var out=[];for(wk=objWalker(this.locateSelectedOptions());wk();)out.push(wk.value.text);return out.length?this.dom.multiple?out:out[0]:null},getValue:function(){var out=[];for(wk=objWalker(this.locateSelectedOptions());wk();)out.push(wk.value.value);return out.length?this.dom.multiple?out:out[0]:null},setValue:function(text){var optmap=this.getOptionMap();if(this.dom.multiple){for(var wk=objWalker(optmap),map=(text instanceof Array||(text=[text]),{}),twk=walker(text);twk();)map[twk.value]=1;for(;wk();)wk.value.selected=!!map[wk.key]}else optmap[text]&&(optmap[text].selected=!0);return this},setRange:function(){var i,wk=walker(arguments),outindex=0,optmap=(this.dom.options.length=0,this._dyData.optmap={},this.parts={},this._dyData.optmap);function mkOption(parent,arg){var value,defsel,sel,text,children,mkGroup=!1,atts={},elem=(arg instanceof Object?"group"==arg.type?(mkGroup=!0,text=arg.text,children=arg._||[]):(text=void 0===arg.text?void 0===arg.value?outindex:arg.value:arg.text,value=void 0===arg.value?arg.text:arg.value,defsel=!!arg.default,sel=!!arg.select):(text=value=arg,defsel=sel=!1),atts.label=text,atts.value=value,defsel&&(atts.defaultSelected="1"),sel&&(atts.selected="1"),baseDocument.createElement(mkGroup?"optgroup":"option"));if(dommy.setAttributes(elem,atts),parent.appendChild(elem),mkGroup)for(var wk=walker(children);wk();)mkOption(elem,wk.value);else(optmap[value]=elem).appendChild(baseDocument.createTextNode(text)),++outindex}for(;wk();)if(wk.value instanceof Array)for(i=0;i<wk.value.length;++i)mkOption(this.dom,wk.value[i]);else mkOption(this.dom,wk.value);return this},getRange:function(){return getProperties(this.getOptionMap())},selections:{enable:function(name,flag){runOptionSetters(curry(setOptionOptionStatus,this,"enable"),name,flag)},select:function(name,flag){runOptionSetters(curry(setOptionOptionStatus,this,"select"),name,flag)},getStatus:function(name,which){return function(fn,name,which){{if(name instanceof Array){for(var out={},wk=walker(name);wk();)out[wk.value]=fn(wk.value,which);return out}return fn(name,which)}}(curry(getOptionOptionStatus,this),name,which)}}});function getTrackerEvtsObj(obj,type){return obj._dyData.evts||(obj._dyData.evts={}),obj._dyData.evts[type]||(obj._dyData.evts[type]={}),obj._dyData.evts[type]}return helpers.css&&helpers.css(options,doc),helpers.drag&&helpers.drag(options,doc,DyHtmlElement),DyHtmlElement}]}(),!function(){(dommy=this.dommy?dommy:{c:{}}).c.css=["dh",function(options,doc){var defaultStylesheet,document=doc.document,walker=doc.walker,objWalker=doc.objWalker;function Stylesheet(ss){this.ss=ss,this.map=null,this.rules=null}function getSSMap(sso){if(!sso.map){var map={};sso.rules=sso.ss.cssRules||sso.ss.rules;for(var wk=walker(sso.rules);wk();){var rule=wk.value;rule.selectorText&&(map[rule.selectorText]=wk.key)}sso.map=map}return sso.map}function getStylesheet(n){return n="number"==typeof n?n:document.styleSheets.length-1,document.styleSheets[n]?new Stylesheet(document.styleSheets[n]):null}function makeStylesheet(){var parent=options.root;if(!parent)return null;for(var wk=walker(parent.childNodes);wk();)if("head"==wk.value.localName){parent=wk.value;break}var style=document.createElement("style");return parent.appendChild(style),new Stylesheet(document.styleSheets[document.styleSheets.length-1])}function getDefaultStylesheet(){return defaultStylesheet=defaultStylesheet||getStylesheet()||makeStylesheet()}dommy.objApply(Stylesheet.prototype,{getRules:function(){return getSSMap(this),this.rules},getRule:function(selector){return this.rules[getSSMap(this)[selector]]},getRuleText:function(selector){selector=this.getRule(selector);return selector&&selector.style?selector.style.cssText:null},setRule:function(selector,properties){if("string"!=typeof properties){for(var arr=[],wk=objWalker(properties);wk();)arr.push(wk.key+": "+wk.value);properties=arr.join("; ")}var map=getSSMap(this),idx=map[selector],ss=this.ss;return map[idx]?ss.deleteRule?ss.deleteRule(idx):ss.removeRule(idx):this.map[selector]=idx=this.rules?this.rules.length:0,ss.insertRule?ss.insertRule(selector+" {"+properties+"}",idx):ss.addRule&&ss.addRule(selector,properties,idx),map[idx]},deleteRule:function(selector){var map=getSSMap(this),selector=map[selector],ss=this.ss;return map[selector]&&(ss(removeRule)?ss.removeRule(selector):ss.deleteRule&&ss.deleteRule(selector)),this}}),doc.css={getStylesheet:getStylesheet,makeStylesheet:makeStylesheet,getRule:function(selector){return getDefaultStylesheet().getRule(selector)},setRule:function(selector,properties){return getDefaultStylesheet().setRule(selector,properties)},setRules:function(selectors){getDefaultStylesheet();for(var wk=dommy.objWalker(selectors);wk();)defaultStylesheet.setRule(wk.key,wk.value)}}}]}(),!function(){function cancelTimeout(){void 0!==this.timer&&(clearTimeout(this.timer),delete this.timer)}function timeoutEvent(request){this.abort(),request.success=!1,request.statusText="timeout",checkin(request)}function toCamelFn(p,l){return l.toUpperCase()}function readyStateEvent(request){if(4==this.xmlhttp.readyState){cancelTimeout();for(var key,rawHeader,headers={},xmlhttp=this.xmlhttp,rawHeaders=this.xmlhttp.getAllResponseHeaders().split("\n");rawHeaders.length;)rawHeader=rawHeaders.shift(),(rawHeader=headRE.exec(rawHeader))&&(key=rawHeader[1].toLowerCase().replace(toCamelRE,toCamelFn),rawHeader=rawHeader[2],headers.hasOwnProperty(key)?headers[key]instanceof Array?headers[key].unshift(rawHeader):headers[key]=[headers[key],rawHeader]:headers[key]=rawHeader);if(request.rcvdHeaders=headers,this.aborted?(request.status=0,request.statusText="abort"):(request.status=xmlhttp.status,request.statusText=xmlhttp.statusText),request.success=200<=request.status&&request.status<300,headers.contentType&&(key=headers.contentType.match(/^\w+\/[\w-]+/))&&key){request.mimeType=key[0],xmlhttp.responseText&&(request.responseText=xmlhttp.responseText),xmlhttp.responseXML&&(request.responseXML=xmlhttp.responseXML),"application/json"==request.mimeType.substr(0,16)&&(request.isJson=1);try{request.responseObject=dommy.json.decode(request.responseText)}catch(e){request.isJson&&(request.success=!1)}request.isJson=!!request.responseObject}checkin(request)}}var factory,headRE=/^([\w-]+)\s*:\s*(.*?)\s*$/,toCamelRE=/-([a-z])/g;function checkin(request){var cbs=request.callbacks;delete request.callbacks,cbs.checkin&&!cbs.checkin(request)||(cbs=(request.success?cbs.success:cbs.failure)||cbs.callback)&&cbs(request)}function constructor(cfg){this.xmlhttp=function(){if(factory)return factory();for(var factories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];factories.length;)try{return(factory=factories.shift())()}catch(e){}throw Error("Browser doesn't do AJAX")}(),this.method=cfg.method,this.uri=cfg.uri||cfg.url,this.checkout=cfg.checkout,this.checkin=cfg.checkin,this.callback=cfg.callback,this.success=cfg.success,this.failure=cfg.failure,this.headers=cfg.headers||{},this.timeout=cfg.timeout}constructor.prototype.abort=function(){cancelTimeout(),this.aborted=1,this.xmlhttp.abort()},constructor.prototype.isIdle=function(){var state=this.xmlhttp.readyState;return!state||3<state},constructor.prototype.request=function(){if(!this.isIdle())return!1;for(var key,arg,body="",cfg={},i=0;i<arguments.length;++i)(arg=arguments[i])instanceof Object?cfg=dommy.objMerge(cfg,arg):"string"==typeof arg&&(body=arg);var method=cfg.method||this.method||(body.length?"POST":"GET"),uri=cfg.uri||this.uri,headers=cfg.headers||{},checkout=cfg.checkout||this.checkout,checkin=cfg.checkin||this.checkin,callback=cfg.callback||this.callback,success=cfg.success||this.success,failure=cfg.failure||this.failure,timeout=cfg.timeout||this.timeout;if(!uri)throw Error("No URI for AJAX request");this.headers&&dommy.objApplyMissing(headers,this.headers),body.length&&void 0===headers.contentType&&(headers.contentType="application/x-www-form-urlencoded; charset=utf-8");var req={info:cfg.info,method:method,uri:uri,callbacks:{checkin:checkin,callback:callback,success:success,failure:failure},sentHeaders:headers,sentBody:body};if(!checkout||checkout(req)){for(key in this.xmlhttp.open(method,uri,!!(checkin||callback||success||failure)),void 0!==timeout&&(this.timer=setTimeout(dommy.curry([this,timeoutEvent],req),timeout)),this.xmlhttp.onreadystatechange=dommy.curry([this,readyStateEvent],req),delete this.aborted,headers)if(headers.hasOwnProperty(key))if(arg=headers[key],key=key.slice(0,1).toUpperCase()+key.slice(1).replace(/([A-Z])/g,"-$1"),arg instanceof Array)for(i=0;i<arg.length;++i)this.xmlhttp.setRequestHeader(key,arg[i]);else this.xmlhttp.setRequestHeader(key,arg);this.xmlhttp.send(body.length?body:null)}},constructor.prototype.postJson=function(obj,options){options=options||{},this.request({headers:{contentType:"application/json"}},dommy.json.encode(obj),options)},(dommy=this.dommy?dommy:{c:{}}).c.ajax=["ext",function(obj){return new constructor(obj)}]}(),!function(){function emulatedEncoder(){function exfugiendusFn(c){var rep={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}[c];return rep||"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)}function encode(o){var typo=typeof o,out=[];if("undefined"==typo||"function"==typo)return null;if(null===o)return"null";if("number"==typeof o.length&&"function"==typeof o.splice){for(var part,i=dommy.walker(o);i();)null!==(part=encode(i.value))&&out.push(part);return"["+out.join(",")+"]"}if("string"==typo)return'"'+(o=exfugiendusRE.test(0)?o.replace(exfugiendusRE,exfugiendusFn):o)+'"';if("number"==typo)return isFinite(o)?String(o):"null";if("boolean"==typo)return String(o);for(i in o)o.hasOwnProperty(i)&&null!==(part=encode(o[i]))&&out.push('"'+i+'":'+part);return"{"+out.join(",")+"}"}var exfugiendusRE=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;return function(o){return void 0===o||"function"==typeof o?"null":encode(o)}}function emulatedDecoder(){var tokenRE=/^\s*([\[\]{},:]|(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|("(?:(?:\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4}))|[^"])*")|\w+)\s*(.*)$/;function err(str){throw Error("JSON error: "+str)}return function(str){var toktype,tokval;function getToken(){str.length||err("premature end of string");var res=tokenRE.exec(str);return res||err("can't parse token "+str),tokval=res[1],str=res[4],toktype=res[2]==tokval?"s":res[3]==tokval?(tokval=eval(tokval),"s"):"l",toktype}function getValue(){if("s"==getToken())return tokval;switch(tokval){case"{":for(var obj={};;){if("s"!=getToken()){if(","==tokval)continue;if("}"==tokval)return toctype="c",obj;err("object with "+tokval+" as key")}var key=tokval;"l"!=getToken()&&":"!=tokval&&err("missing colon before member"),obj[key]=getValue(),"p"==toktype&&err("unexpected "+tokval+" in object")}case"[":for(var arr=[];;){key=getValue();if("p"==toktype){if(","==tokval)continue;if("]"==tokval)return toktype="c",arr;err("array with "+tokval+" instead of element")}arr.push(key)}case"true":return toktype="b",!0;case"false":return!(toktype="b");case"null":return toktype="b",null;case",":case":":case"]":case"}":return toktype="p",tokval;default:err("unknown token '"+tokval)}}return getValue()}}var json={};this.JSON instanceof Object&&this.JSON.stringify instanceof Function&&this.JSON.parse instanceof Function?(json.encode=JSON.stringify,json.decode=JSON.parse):(json.encode=emulatedEncoder(),json.decode=emulatedDecoder()),this.dommy||(dommy={c:{}}),dommy.c.json=["ext",json]}(),!function(){(dommy=this.dommy?dommy:{c:{}}).c.svg=["cls",function(nss,options,doc,getContextMethods,helpers){dommy.walker,dommy.objWalker,dommy.curry;var baseDocument=options.document,DyHtmlElement=nss.html||nss[""],byTag={};function DySvgElement(elem){DyHtmlElement.call(this,elem)}return dommy.extend(DyHtmlElement,DySvgElement,{toUrl:function(){return"data:image/svg+xml,"+encodeURIComponent(this.toXML())}},getContextMethods("svg",function(node){return new(byTag[node.localName]||DySvgElement)(node)},function(tag){tag=baseDocument.createElementNS("http://www.w3.org/2000/svg",tag);return"svg"==tag.localName&&(tag.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),tag.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink")),tag})),helpers.css&&helpers.css(options,doc),DySvgElement}]}();
